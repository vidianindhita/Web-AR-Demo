<!doctype HTML>
<html>
<script src="https://aframe.io/releases/0.9.0/aframe.min.js"></script>
<script src="https://cdn.rawgit.com/jeromeetienne/AR.js/1.6.2/aframe/build/aframe-ar.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<link rel="stylesheet" href="css/style.css">
  <body>
  	<div id="placement">
  		<!-- <button class="button-song">
	        SONG
	    </button> -->
	    <!-- <img id="image-object" style="width: 300px; height: 300px; border-style: none; outline: none;">
	    <h3 id="text-object"></h3> -->
	</div>
    <a-scene embedded arjs="debugUIEnabled: false; sourceType: webcam;">
    	<!-- <a-assets>
	      	<img id="my-image" src="assets/mango.png">
	    </a-assets>

	    <a-image position="0 0.5 0" src="#my-image"></a-image> -->
    	<!-- <a-assets>
			<a-asset-item id="pyramid" src="assets/octahedron/scene.gltf"></a-asset-item>
		</a-assets>
		<a-entity gltf-model="#pyramid" scale="0.01 0.01 0.01"></a-entity> -->

    	<!-- <a-box position='0 0.5 0' material='color: yellow;'></a-box> -->
    	<a-box position="-1 0.5 -3" rotation="0 45 0" color="#4CC3D9" id="box-object" style="display: none"></a-box>
      	<a-sphere position="0 1.25 -5" radius="1.25" color="#EF2D5E" id="sphere-object"></a-sphere>
      	<a-cylinder position="1 0.75 -3" radius="0.5" height="1.5" color="#FFC65D" id="cylinder-object"></a-cylinder>
      <!-- <a-marker preset="hiro">
          <a-box position='0 0.5 0' material='color: yellow;'></a-box>
          <a-image id="image-container" src="assets/mango.png"></a-image>
      </a-marker> -->
      <!-- <a-image id="image-container" src="assets/mango.png"></a-image> -->
      <a-entity camera></a-entity>
    </a-scene>
  </body>
  <script>
	var dance;
	var value;

  	$(document).ready(function () {
        $(".button-song").click(function () {
            $.get("https://staging.vidia.site/obtain_song_info", function(data, status){
            	dance = data.songFeatures.danceability;

            	if (dance < 0.25) {
            		$('#text-object').text("Calm Song");
            		$('#image-object').attr('src', 'assets/mango.png');
            	} else if (dance >= 0.25 && dance < 0.5) {
            		$('#text-object').text("Chill Song");
            		$('#image-object').attr('src', 'assets/banana.png');
            	} else if (dance >= 0.5 && dance < 0.75) {
					$('#text-object').text("Happy Song");
					$('#image-object').attr('src', 'assets/orange.png');
            	} else {
            		$('#text-object').text("Energetic Song");
            		$('#image-object').attr('src', 'assets/pineapple.png');
            	}
                // alert("Data: " + data + "\nStatus: " + status);
                console.log(dance);
            });
        });
    });

    function fetchdata(){
		$.ajax({
			url: 'https://staging.vidia.site/obtain_song_info',
			type: 'get',
			success: function(response){
			   	// Perform operation on the return value
			   	//alert(response);
			   	value = response.songFeatures.danceability;
			   	if (value < 0.25) {
            		$('#text-object').text("Calm Song");
            		$('#image-object').attr('src', 'assets/mango.png');
            	} else if (value >= 0.25 && value < 0.5) {
            		$('#text-object').text("Chill Song");
            		$('#image-object').attr('src', 'assets/banana.png');
            	} else if (value >= 0.5 && value < 0.75) {
					$('#text-object').text("Happy Song");
					$('#image-object').attr('src', 'assets/orange.png');
            	} else {
            		$('#text-object').text("Energetic Song");
            		$('#image-object').attr('src', 'assets/pineapple.png');
            	}
			   	console.log(value);
			}
		});
	}

	$(document).ready(function(){
		setInterval(fetchdata,500);
	});

  </script>
</html>